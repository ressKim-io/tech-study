# Istio Service Mesh ì™„ì „ ê°€ì´ë“œ

## ëª©ì°¨
1. [Istioë€ ë¬´ì—‡ì¸ê°€?](#istioë€-ë¬´ì—‡ì¸ê°€)
2. [Istio ì•„í‚¤í…ì²˜](#istio-ì•„í‚¤í…ì²˜)
3. [Istio í•µì‹¬ êµ¬ì„±ìš”ì†Œ](#istio-í•µì‹¬-êµ¬ì„±ìš”ì†Œ)
4. [Istio í•µì‹¬ ë¦¬ì†ŒìŠ¤](#istio-í•µì‹¬-ë¦¬ì†ŒìŠ¤)
5. [ë³´ì•ˆ ê¸°ëŠ¥](#ë³´ì•ˆ-ê¸°ëŠ¥)
6. [ì‹¤ë¬´ ì‚¬ìš© íŒ¨í„´](#ì‹¤ë¬´-ì‚¬ìš©-íŒ¨í„´)
7. [Ingress vs Istio Gateway](#ingress-vs-istio-gateway)
8. [ë„êµ¬ ìƒíƒœê³„](#ë„êµ¬-ìƒíƒœê³„)

---

## Istioë€ ë¬´ì—‡ì¸ê°€?

### ë¬¸ì œì˜ ì‹œì‘: ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì˜ ë”œë ˆë§ˆ

**ëª¨ë†€ë¦¬ì‹ ì‹œì ˆ (ì˜›ë‚ )**:
```
[Client] â”€â”€â”€â”€ HTTP â”€â”€â”€â”€ [Single App]
                         â””â”€â”€ Database
```
- ë‹¨ìˆœí•˜ê³  ëª…í™•
- ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œ ìµœì†Œ
- í•˜ì§€ë§Œ í™•ì¥ì„± ì œí•œ

**ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì‹œì ˆ (í˜„ì¬)**:
```
[Client] â”€â”€â”€â”€ ? â”€â”€â”€â”€ [Service A] â”€â”€â”€â”
                     [Service B] â”€â”€â”€â”¼â”€â”€ ì–´ë–»ê²Œ ê´€ë¦¬?
                     [Service C] â”€â”€â”€â”˜
                     [Service D]
                     [Service E]
                     ...
```

**ë¬¸ì œì ë“¤**:
1. **ì§„ì…ì  í˜¼ë€**: í´ë¼ì´ì–¸íŠ¸ê°€ ì–´ëŠ ì„œë¹„ìŠ¤ë¡œ ê°€ì•¼ í•˜ë‚˜?
2. **ì¸ì¦ ì¤‘ë³µ**: ëª¨ë“  ì„œë¹„ìŠ¤ë§ˆë‹¤ ì¸ì¦ ë¡œì§?
3. **íš¡ë‹¨ ê´€ì‹¬ì‚¬**: ë¡œê¹…, ëª¨ë‹ˆí„°ë§, ë³´ì•ˆì´ ëª¨ë“  ê³³ì—...
4. **ì„œë¹„ìŠ¤ ê°„ í†µì‹ **: Aâ†’Bâ†’C í˜¸ì¶œ ì²´ì¸ì˜ ë³µì¡ë„
5. **ì¥ì•  ì „íŒŒ**: í•˜ë‚˜ ì£½ìœ¼ë©´ ì „ì²´ ì£½ìŒ

### Kong vs Istio - í•´ê²°í•˜ëŠ” ë¬¸ì œê°€ ë‹¤ë¦„

```
Kongì´ í•´ê²°í•˜ëŠ” ë¬¸ì œ (North-South Traffic)
Client/Frontend â†’ API Gateway(Kong) â†’ Backend Services

Istioê°€ í•´ê²°í•˜ëŠ” ë¬¸ì œ (East-West Traffic)  
Service A â†” Service B â†” Service C â†” Service D
         â†˜             â†—
           Service E â†—

Kong: ì™¸ë¶€ íŠ¸ë˜í”½ ê´€ë¦¬ ì „ë¬¸
Istio: ì„œë¹„ìŠ¤ ê°„ í†µì‹  ê´€ë¦¬ ì „ë¬¸
```

---

## Istio ì•„í‚¤í…ì²˜

### ì „ì²´ ì•„í‚¤í…ì²˜ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ISTIO SERVICE MESH                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚   CONTROL PLANE     â”‚                                                    â”‚
â”‚  â”‚                     â”‚                                                    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     ì„¤ì • ë°°í¬ (gRPC)                               â”‚
â”‚  â”‚  â”‚    ISTIOD     â”‚  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—   â”‚
â”‚  â”‚  â”‚               â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â”‚ â”‚  Pilot    â”‚ â”‚  â”‚ â† íŠ¸ë˜í”½ ê´€ë¦¬ (VirtualService, DestinationRule) â•‘   â”‚
â”‚  â”‚  â”‚ â”‚           â”‚ â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â”‚ â”‚  Citadel  â”‚ â”‚  â”‚ â† ë³´ì•ˆ ê´€ë¦¬ (mTLS ì¸ì¦ì„œ ìë™ ë°œê¸‰/ê°±ì‹ )          â•‘   â”‚
â”‚  â”‚  â”‚ â”‚           â”‚ â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â”‚ â”‚  Galley   â”‚ â”‚  â”‚ â† ì„¤ì • ê²€ì¦ (ì˜ëª»ëœ YAML ì²´í¬)                   â•‘   â”‚
â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚                                                â•‘   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                                                â•‘   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                â•‘   â”‚
â”‚                                                                          â•‘   â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•   â”‚
â”‚                            DATA PLANE                                        â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  USER SERVICE   â”‚    â”‚ ORDER SERVICE   â”‚    â”‚PAYMENT SERVICE  â”‚         â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚         â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚  â”‚ â”‚    App      â”‚ â”‚    â”‚ â”‚    App      â”‚ â”‚    â”‚ â”‚    App      â”‚ â”‚         â”‚
â”‚  â”‚ â”‚   :8080     â”‚ â”‚    â”‚ â”‚   :8080     â”‚ â”‚    â”‚ â”‚   :8080     â”‚ â”‚         â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚  â”‚       â†•         â”‚    â”‚       â†•         â”‚    â”‚       â†•   [118;1:3u      â”‚         â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚
â”‚  â”‚ â”‚ Envoy Proxy â”‚ â”‚    â”‚ â”‚ Envoy Proxy â”‚ â”‚    â”‚ â”‚ Envoy Proxy â”‚ â”‚         â”‚
â”‚  â”‚ â”‚   :15001    â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚   :15001    â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚   :15001    â”‚ â”‚         â”‚
â”‚  â”‚ â”‚   :15006    â”‚ â”‚    â”‚ â”‚   :15006    â”‚ â”‚    â”‚ â”‚   :15006    â”‚ â”‚         â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚           â†•                       â†•                       â†•                â”‚
â”‚    ëª¨ë“  íŠ¸ë˜í”½ì´ Envoyë¥¼ ê±°ì³ì„œ mTLSë¡œ ì•”í˜¸í™”ë˜ì–´ í†µì‹                           â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì™¸ë¶€ íŠ¸ë˜í”½ ì§„ì…:
Internet â†’ Istio Gateway â†’ Istio Ingress Gateway Pod â†’ Service Mesh
```

### ì‹¤ì œ ìš”ì²­ íë¦„ ìƒì„¸

```
User Request Flow (í•œ ë²ˆì˜ ì£¼ë¬¸ ìš”ì²­):

Step 1: ì™¸ë¶€ì—ì„œ ì§„ì…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”     HTTP     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Istio Gateway   â”‚
â”‚ (Web)   â”‚             â”‚ (Ingress)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
Step 2: ë¼ìš°íŒ… ê²°ì •
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ VirtualService  â”‚
                        â”‚ ê·œì¹™ ì ìš©       â”‚
                        â”‚ /api/orders â†’   â”‚
                        â”‚ order-service   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
Step 3: Order Service í˜¸ì¶œ
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚                ORDER SERVICE POD                          â”‚
    â”‚                                                           â”‚
    â”‚  Inbound Traffic                                          â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    localhost    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
    â”‚  â”‚ Envoy Proxy â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Order App   â”‚         â”‚
    â”‚  â”‚ :15001      â”‚                 â”‚ :8080       â”‚         â”‚
    â”‚  â”‚             â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚             â”‚         â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    response     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
    â”‚         â”‚                               â”‚                â”‚
    â”‚         â”‚ 1. mTLS ë³µí˜¸í™”                â”‚ 2. ë¹„ì¦ˆë‹ˆìŠ¤     â”‚
    â”‚         â”‚ 2. ì¸ì¦/ì¸ê°€ í™•ì¸              â”‚    ë¡œì§ ì²˜ë¦¬    â”‚
    â”‚         â”‚ 3. Rate Limiting             â”‚                â”‚
    â”‚         â”‚ 4. ë©”íŠ¸ë¦­ ìˆ˜ì§‘                â”‚                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                               â”‚
              â–¼                               â–¼
Step 4: Order â†’ Payment ì„œë¹„ìŠ¤ í˜¸ì¶œ í•„ìš”

    Outbound Traffic                   
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    Cluster IP    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Order App   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Envoy Proxy â”‚
    â”‚ :8080       â”‚ payment-service  â”‚ :15006      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     :8080        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚ DestinationRule â”‚
                                    â”‚ ì ìš©:           â”‚
                                    â”‚ - Load Balancer â”‚
                                    â”‚ - Circuit Break â”‚
                                    â”‚ - Retry Policy  â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼ mTLS ì•”í˜¸í™”
Step 5: Payment Serviceì—ì„œ ì²˜ë¦¬
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚               PAYMENT SERVICE POD                         â”‚
    â”‚                                                           â”‚
    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    localhost    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
    â”‚  â”‚ Envoy Proxy â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Payment App â”‚         â”‚
    â”‚  â”‚ :15001      â”‚                 â”‚ :8080       â”‚         â”‚
    â”‚  â”‚             â”‚ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚             â”‚         â”‚
    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚                           â–²
                    â”‚ Response                  â”‚
                    â–¼                           â”‚
Step 6: ì‘ë‹µ ê²½ë¡œ (ì—­ìˆœ)
Payment App â†’ Payment Envoy â†’ Order Envoy â†’ Order App â†’ Gateway â†’ Client

ëª¨ë“  ë‹¨ê³„ì—ì„œ:
âœ“ mTLSë¡œ ì•”í˜¸í™”
âœ“ ë©”íŠ¸ë¦­ ìˆ˜ì§‘ (Prometheus)
âœ“ íŠ¸ë ˆì´ì‹± (Jaeger)
âœ“ ë¡œê¹…
```

---

## Istio í•µì‹¬ êµ¬ì„±ìš”ì†Œ

### 1. Istiod - í†µí•© ì»¨íŠ¸ë¡¤ í”Œë ˆì¸

**ì´ì „ ë²„ì „ (ë³µì¡í–ˆë˜ ì‹œì ˆ)**:
```yaml
# Istio 1.4 ì´ì „ - ì—¬ëŸ¬ ì»´í¬ë„ŒíŠ¸ë¡œ ë¶„ë¦¬
- Pilot: íŠ¸ë˜í”½ ê´€ë¦¬
- Mixer: ì •ì±…/í…”ë ˆë©”íŠ¸ë¦¬  
- Citadel: ë³´ì•ˆ
- Galley: ì„¤ì • ê´€ë¦¬
```

**í˜„ì¬ ë²„ì „ (ë‹¨ìˆœí•´ì§„ í˜„ì¬)**:
```yaml
# Istio 1.5+ - ëª¨ë“  ê²ƒì´ Istiodë¡œ í†µí•©
apiVersion: apps/v1
kind: Deployment
metadata:
  name: istiod
  namespace: istio-system
spec:
  template:
    spec:
      containers:
      - name: discovery
        image: docker.io/istio/pilot:1.19.0
        env:
        - name: PILOT_CERT_PROVIDER
          value: istiod
        - name: PILOT_ENABLE_WORKLOAD_ENTRY_AUTOREGISTRATION  
          value: "true"
        ports:
        - containerPort: 8080  # HTTP ëª¨ë‹ˆí„°ë§
        - containerPort: 15010 # gRPC XDS ì„œë²„
        - containerPort: 15011 # Webhook
        - containerPort: 15014 # í—¬ìŠ¤ì²´í¬
```

**Istiodì˜ í•µì‹¬ ì—­í• **:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Istiod ë‚´ë¶€                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                             â”‚
â”‚ Service Discovery     Configuration       Certificate Mgmt  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ K8s Services  â”‚    â”‚ VirtualServiceâ”‚   â”‚ mTLS Certs    â”‚ â”‚
â”‚ â”‚ Endpoints     â”‚    â”‚ DestinationRuleâ”‚   â”‚ Auto Rotation â”‚ â”‚
â”‚ â”‚ ìë™ ë°œê²¬      â”‚    â”‚ Gateway       â”‚   â”‚ 24h ê°±ì‹       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                     â”‚                   â”‚        â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                               â”‚                            â”‚
â”‚                               â–¼                            â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                    â”‚ XDS API Serverâ”‚                       â”‚
â”‚                    â”‚ Envoy ì„¤ì •    â”‚                       â”‚
â”‚                    â”‚ gRPC Stream   â”‚                       â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼ gRPCë¡œ ì‹¤ì‹œê°„ ì„¤ì • ë°°í¬
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Envoy Proxies   â”‚
                    â”‚ (ëª¨ë“  Pod)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Sidecar Pattern ìƒì„¸

```
ê¸°ì¡´ ë°©ì‹ (Sidecar ì—†ìŒ):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POD                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            Application                      â”‚    â”‚
â”‚  â”‚                                             â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚    â”‚
â”‚  â”‚  â”‚   ë¹„ì¦ˆë‹ˆìŠ¤   â”‚  â”‚  ë„¤íŠ¸ì›Œí¬    â”‚          â”‚    â”‚
â”‚  â”‚  â”‚    ë¡œì§     â”‚  â”‚    ë¡œì§     â”‚          â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚             â”‚          â”‚    â”‚
â”‚  â”‚  â”‚ - ì£¼ë¬¸ ì²˜ë¦¬  â”‚  â”‚ - HTTP í´ë¼ â”‚          â”‚    â”‚
â”‚  â”‚  â”‚ - ê²°ì œ ê²€ì¦  â”‚  â”‚ - ë¡œë“œë°¸ëŸ°ì‹± â”‚          â”‚    â”‚
â”‚  â”‚  â”‚ - ì¬ê³  í™•ì¸  â”‚  â”‚ - ì¬ì‹œë„    â”‚          â”‚    â”‚
â”‚  â”‚  â”‚             â”‚  â”‚ - íƒ€ì„ì•„ì›ƒ   â”‚          â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ë¬¸ì œ: ë„¤íŠ¸ì›Œí¬ ë¡œì§ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ì„ì„


Istio Sidecar ë°©ì‹:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    POD                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    Application      â”‚  â”‚   Envoy Proxy       â”‚   â”‚
â”‚  â”‚                     â”‚  â”‚   (Sidecar)         â”‚   â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚ â”‚   ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§   â”‚ â”‚  â”‚ â”‚  ëª¨ë“  ë„¤íŠ¸ì›Œí¬   â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                 â”‚ â”‚  â”‚ â”‚     ê¸°ëŠ¥        â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ - ì£¼ë¬¸ ì²˜ë¦¬      â”‚ â”‚  â”‚ â”‚                 â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ - ê²°ì œ ê²€ì¦      â”‚ â”‚â—„â”€â”¤ â”‚ - ë¡œë“œë°¸ëŸ°ì‹±     â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ - ì¬ê³  í™•ì¸      â”‚ â”‚  â”‚ â”‚ - mTLS         â”‚ â”‚   â”‚
â”‚  â”‚ â”‚                 â”‚ â”‚  â”‚ â”‚ - ì¬ì‹œë„        â”‚ â”‚   â”‚
â”‚  â”‚ â”‚ localhost:8080  â”‚ â”‚  â”‚ â”‚ - ì„œí‚·ë¸Œë ˆì´ì»¤   â”‚ â”‚   â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚ - ë©”íŠ¸ë¦­ ìˆ˜ì§‘    â”‚ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚ - ë¶„ì‚° ì¶”ì       â”‚ â”‚   â”‚
â”‚                           â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ì¥ì : ê´€ì‹¬ì‚¬ ì™„ì „ ë¶„ë¦¬, ì–¸ì–´ ë¬´ê´€, ì¤‘ì•™ ê´€ë¦¬
```

---

## Istio í•µì‹¬ ë¦¬ì†ŒìŠ¤

### 1. VirtualService - íŠ¸ë˜í”½ ë¼ìš°íŒ…ì˜ í•µì‹¬

**ê¸°ë³¸ êµ¬ì¡°**:
```yaml
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: user-service-routing
  namespace: ecommerce
spec:
  hosts:
  - user-service              # K8s Serviceëª…
  - user-service.ecommerce.svc.cluster.local
  
  gateways:
  - mesh                      # ì„œë¹„ìŠ¤ ë©”ì‹œ ë‚´ë¶€ íŠ¸ë˜í”½
  - user-service-gateway      # ì™¸ë¶€ íŠ¸ë˜í”½ (Gateway ë¦¬ì†ŒìŠ¤)
  
  http:
  - match:
    - headers:
        version:
          exact: v2
    route:
    - destination:
        host: user-service
        subset: v2              # DestinationRuleì—ì„œ ì •ì˜
      weight: 100
      
  - match:
    - uri:
        prefix: /api/v1/users
    route:
    - destination:
        host: user-service
        subset: v1
      weight: 90                # 90% íŠ¸ë˜í”½
    - destination:
        host: user-service  
        subset: v2
      weight: 10                # 10% íŠ¸ë˜í”½ (ì¹´ë‚˜ë¦¬)
      
    # ê³ ê¸‰ íŠ¸ë˜í”½ ì •ì±…
    fault:                      # ì¥ì•  ì£¼ì… (í…ŒìŠ¤íŠ¸ìš©)
      delay:
        percentage:
          value: 0.1
        fixedDelay: 5s
      abort:
        percentage:
          value: 0.1
        httpStatus: 500
        
    retries:                    # ì¬ì‹œë„ ì •ì±…
      attempts: 3
      perTryTimeout: 2s
      retryOn: gateway-error,connect-failure,refused-stream
      
    timeout: 10s                # ì „ì²´ íƒ€ì„ì•„ì›ƒ
```

**ì‹¤ë¬´ ê³ ê¸‰ ë¼ìš°íŒ… ì˜ˆì‹œ**:
```yaml
# 1. ì‚¬ìš©ì ê·¸ë£¹ë³„ ë¼ìš°íŒ… (A/B í…ŒìŠ¤íŒ…)
apiVersion: networking.istio.io/v1beta1  
kind: VirtualService
metadata:
  name: ab-testing-routing
spec:
  hosts:
  - recommendation-service
  http:
  - match:
    - headers:
        user-group:
          exact: beta-users
    route:
    - destination:
        host: recommendation-service
        subset: ml-v2           # ìƒˆë¡œìš´ ML ëª¨ë¸
  
  - match:
    - headers:
        country:
          exact: KR
    route:
    - destination:
        host: recommendation-service
        subset: korea-optimized # í•œêµ­ ìµœì í™” ë²„ì „
        
  - route:                      # ê¸°ë³¸ ë¼ìš°íŒ…
    - destination:
        host: recommendation-service
        subset: stable
---
# 2. ì§€ì—­ë³„ ë¼ìš°íŒ…
apiVersion: networking.istio.io/v1beta1
kind: VirtualService  
metadata:
  name: geo-routing
spec:
  hosts:
  - payment-service
  http:
  - match:
    - headers:
        region:
          exact: asia
    route:
    - destination:
        host: payment-service
        subset: asia-cluster
  - match:
    - headers:  
        region:
          exact: europe
    route:
    - destination:
        host: payment-service
        subset: europe-cluster
```

### 2. DestinationRule - ì„œë¹„ìŠ¤ ë™ì‘ ì •ì˜

```yaml
apiVersion: networking.istio.io/v1beta1
kind: DestinationRule
metadata:
  name: user-service-destination
  namespace: ecommerce
spec:
  host: user-service
  
  # ì „ì²´ ì„œë¹„ìŠ¤ì— ì ìš©ë˜ëŠ” ì •ì±…
  trafficPolicy:
    loadBalancer:
      simple: LEAST_CONN        # ROUND_ROBIN, RANDOM, PASSTHROUGH
    connectionPool:
      tcp:
        maxConnections: 100     # ìµœëŒ€ ì—°ê²° ìˆ˜
        connectTimeout: 30s
        keepAlive:
          time: 7200s
          interval: 75s
      http:
        http1MaxPendingRequests: 64   # HTTP/1.1 ëŒ€ê¸° ìš”ì²­ ìˆ˜
        http2MaxRequests: 1000        # HTTP/2 ìµœëŒ€ ìš”ì²­ ìˆ˜
        maxRequestsPerConnection: 10   # ì—°ê²°ë‹¹ ìµœëŒ€ ìš”ì²­
        maxRetries: 3
        idleTimeout: 90s
        h2UpgradePolicy: UPGRADE      # HTTP/2 ì—…ê·¸ë ˆì´ë“œ
        
    # Circuit Breaker ì„¤ì •
    outlierDetection:
      consecutiveGatewayErrors: 5     # ì—°ì† ê²Œì´íŠ¸ì›¨ì´ ì—ëŸ¬ ìˆ˜
      consecutive5xxErrors: 5         # ì—°ì† 5xx ì—ëŸ¬ ìˆ˜  
      interval: 30s                   # ë¶„ì„ ê°„ê²©
      baseEjectionTime: 30s           # ê¸°ë³¸ ì œì™¸ ì‹œê°„
      maxEjectionPercent: 50          # ìµœëŒ€ ì œì™¸ ë¹„ìœ¨
      minHealthPercent: 30            # ìµœì†Œ ê±´ê°•í•œ ì¸ìŠ¤í„´ìŠ¤ ë¹„ìœ¨
      
  # ì„œë¸Œì…‹ ì •ì˜ (ë²„ì „ë³„ ë¶„ë¦¬)
  subsets:
  - name: v1
    labels:
      version: v1
    trafficPolicy:              # v1ë§Œì˜ íŠ¹ë³„í•œ ì •ì±…
      loadBalancer:
        simple: ROUND_ROBIN
        
  - name: v2  
    labels:
      version: v2
    trafficPolicy:              # v2ëŠ” ë” ì—„ê²©í•œ ì •ì±…
      connectionPool:
        tcp:
          maxConnections: 50
      outlierDetection:
        consecutive5xxErrors: 3  # v2ëŠ” ë” ë¯¼ê°í•˜ê²Œ
        
  - name: canary
    labels:
      version: canary
    trafficPolicy:
      loadBalancer:
        simple: RANDOM
```

### 3. Gateway - ì™¸ë¶€ íŠ¸ë˜í”½ ì§„ì…ì 

```yaml
# Istio Gateway (ì™¸ë¶€ íŠ¸ë˜í”½ìš©)
apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: ecommerce-gateway
  namespace: ecommerce
spec:
  selector:
    istio: ingressgateway       # Istio Ingress Gateway Pod ì„ íƒ
  servers:
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - api.ecommerce.com
    - admin.ecommerce.com
    tls:
      httpsRedirect: true       # HTTP â†’ HTTPS ë¦¬ë‹¤ì´ë ‰íŠ¸
      
  - port:
      number: 443
      name: https  
      protocol: HTTPS
    hosts:
    - api.ecommerce.com
    - admin.ecommerce.com
    tls:
      mode: SIMPLE
      credentialName: ecommerce-tls-secret  # K8s Secret
      
  - port:                       # gRPC ì§€ì›
      number: 9443
      name: grpc-tls
      protocol: GRPC
    hosts:
    - grpc.ecommerce.com
    tls:
      mode: SIMPLE
      credentialName: grpc-tls-secret
---
# Gatewayì™€ ì—°ê²°ë˜ëŠ” VirtualService
apiVersion: networking.istio.io/v1beta1
kind: VirtualService
metadata:
  name: ecommerce-routing
spec:
  hosts:
  - api.ecommerce.com
  gateways:
  - ecommerce-gateway           # ìœ„ì—ì„œ ì •ì˜í•œ Gateway
  http:
  - match:
    - uri:
        prefix: /api/v1/users
    route:
    - destination:
        host: user-service
        port:
          number: 8080
          
  - match:
    - uri:
        prefix: /api/v1/products  
    route:
    - destination:
        host: product-service
        port:
          number: 8080
```

---

## ë³´ì•ˆ ê¸°ëŠ¥

### 1. ìë™ mTLS (ìƒí˜¸ TLS)

```
Before Istio (ìˆ˜ë™ ì¸ì¦ì„œ ê´€ë¦¬):

Service A                           Service B
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             â”‚                    â”‚             â”‚
â”‚ ê°œë°œìê°€     â”‚ â”€â”€â”€â”€ HTTP (í‰ë¬¸) â”€â”€â–º â”‚ ê°œë°œìê°€     â”‚
â”‚ ìˆ˜ë™ìœ¼ë¡œ     â”‚                    â”‚ ìˆ˜ë™ìœ¼ë¡œ     â”‚
â”‚ ì¸ì¦ì„œ      â”‚                    â”‚ ì¸ì¦ì„œ      â”‚
â”‚ ê´€ë¦¬ ğŸ˜°     â”‚                    â”‚ ê´€ë¦¬ ğŸ˜°     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ë¬¸ì œ:
âŒ í‰ë¬¸ í†µì‹  (ë³´ì•ˆ ìœ„í—˜)
âŒ ì¸ì¦ì„œ ìˆ˜ë™ ê´€ë¦¬
âŒ ì¸ì¦ì„œ ë§Œë£Œ ì¶”ì  ì–´ë ¤ì›€
âŒ í‚¤ ë°°í¬/íšŒì „ ë³µì¡


After Istio (ìë™ mTLS):

Service A Pod                      Service B Pod
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚ â”‚  App A  â”‚  â”‚ Envoy A â”‚       â”‚ â”‚ â”‚ Envoy B â”‚  â”‚  App B  â”‚       â”‚
â”‚ â”‚         â”‚  â”‚         â”‚       â”‚ â”‚ â”‚         â”‚  â”‚         â”‚       â”‚
â”‚ â”‚ :8080   â”‚â—„â”€â”¤ :15001  â”‚       â”‚ â”‚ â”‚ :15001  â”œâ”€â–ºâ”‚ :8080   â”‚       â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                                 â”‚
                  â”‚    mTLS Encrypted Traffic       â”‚
                  â”‚ â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â–º â”‚
                  â”‚                                 â”‚
                  â–¼                                 â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚ Client Cert     â”‚               â”‚ Server Cert     â”‚
         â”‚ (ìë™ ë°œê¸‰)      â”‚               â”‚ (ìë™ ë°œê¸‰)      â”‚
         â”‚                 â”‚               â”‚                 â”‚
         â”‚ ìœ íš¨ê¸°ê°„: 24ì‹œê°„  â”‚               â”‚ ìœ íš¨ê¸°ê°„: 24ì‹œê°„  â”‚
         â”‚ ìë™ ê°±ì‹        â”‚               â”‚ ìë™ ê°±ì‹        â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â–²                                 â–²
                  â”‚                                 â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                             â”‚   Istiod    â”‚
                             â”‚             â”‚
                             â”‚ ì¸ì¦ì„œ ìë™  â”‚
                             â”‚ ë°œê¸‰/ê°±ì‹     â”‚
                             â”‚             â”‚
                             â”‚ CA ë£¨íŠ¸í‚¤   â”‚
                             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

í˜œíƒ:
âœ… ëª¨ë“  í†µì‹  ìë™ ì•”í˜¸í™”
âœ… ì¸ì¦ì„œ ìë™ ë°œê¸‰/ê°±ì‹  (24ì‹œê°„ ì£¼ê¸°)
âœ… ê°œë°œì ê°œì… ë¶ˆí•„ìš”
âœ… Zero Trust ë„¤íŠ¸ì›Œí¬
```

**ê¸°ë³¸ ë™ì‘**:
```yaml
# IstioëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ëª¨ë“  ì„œë¹„ìŠ¤ ê°„ í†µì‹ ì„ ìë™ìœ¼ë¡œ mTLSë¡œ ì•”í˜¸í™”
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication
metadata:
  name: default
  namespace: ecommerce
spec:
  mtls:
    mode: STRICT                # STRICT, PERMISSIVE, DISABLE
---
# íŠ¹ì • ì„œë¹„ìŠ¤ë§Œ ì˜ˆì™¸ ì²˜ë¦¬
apiVersion: security.istio.io/v1beta1
kind: PeerAuthentication  
metadata:
  name: legacy-service
  namespace: ecommerce
spec:
  selector:
    matchLabels:
      app: legacy-payment       # ë ˆê±°ì‹œ ì„œë¹„ìŠ¤ëŠ” mTLS ë¶ˆê°€
  mtls:
    mode: DISABLE
```

### 2. ì„¸ë°€í•œ ê¶Œí•œ ì œì–´ (Authorization)

```yaml
# RBAC ê¸°ë°˜ ì„œë¹„ìŠ¤ ê°„ ì ‘ê·¼ ì œì–´
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: payment-service-authz
  namespace: ecommerce
spec:
  selector:
    matchLabels:
      app: payment-service      # Payment ì„œë¹„ìŠ¤ ë³´í˜¸
  rules:
  - from:
    - source:
        principals: 
        - "cluster.local/ns/ecommerce/sa/order-service"  # Order ì„œë¹„ìŠ¤ë§Œ í—ˆìš©
    to:
    - operation:
        methods: ["POST"]       # POSTë§Œ í—ˆìš©
        paths: ["/api/v1/payments/create"]
        
  - from:  
    - source:
        principals:
        - "cluster.local/ns/ecommerce/sa/user-service"   # User ì„œë¹„ìŠ¤ëŠ”
    to:
    - operation:
        methods: ["GET"]        # ì¡°íšŒë§Œ í—ˆìš©
        paths: ["/api/v1/payments/history/*"]
        
  - from:
    - source:
        namespaces: ["admin"]   # Admin ë„¤ì„ìŠ¤í˜ì´ìŠ¤ëŠ” ëª¨ë“  ê¶Œí•œ
    to:
    - operation:
        methods: ["*"]
---
# JWT í† í° ê¸°ë°˜ ì¸ì¦
apiVersion: security.istio.io/v1beta1
kind: RequestAuthentication
metadata:
  name: jwt-auth
  namespace: ecommerce
spec:
  selector:
    matchLabels:
      app: user-service
  jwtRules:
  - issuer: "https://auth.ecommerce.com"
    jwksUri: "https://auth.ecommerce.com/.well-known/jwks.json"
    audiences:
    - "ecommerce-api"
    forwardOriginalToken: true  # ì›ë³¸ í† í°ì„ ë°±ì—”ë“œë¡œ ì „ë‹¬
---
# JWT í† í° ê¸°ë°˜ ê¶Œí•œ ì œì–´
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: jwt-authz
spec:
  selector:
    matchLabels:
      app: user-service
  rules:
  - from:
    - source:
        requestPrincipals: ["https://auth.ecommerce.com/user-12345"]
    when:
    - key: request.auth.claims[role]
      values: ["admin", "user"]
    - key: request.auth.claims[verified]  
      values: ["true"]
```

---

## ì‹¤ë¬´ ì‚¬ìš© íŒ¨í„´

### ê¸°ì—… ê·œëª¨ë³„ ì‚¬ìš© íŒ¨í„´

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ê¸°ì—… ê·œëª¨ë³„ ë„ì… íŒ¨í„´                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  ìŠ¤íƒ€íŠ¸ì—… (1-10ê°œ ì„œë¹„ìŠ¤)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚ Kong Gateway    â”‚ â† 90% ì„ íƒ                                          â”‚
â”‚  â”‚ + Nginx Ingress â”‚                                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚  ì´ìœ : ë¹ ë¥¸ êµ¬ì¶•, ë‚®ì€ í•™ìŠµë¹„ìš©, ì¦‰ì‹œ íš¨ê³¼                                â”‚
â”‚                                                                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‚
â”‚                                                                         â”‚
â”‚  ì¤‘ê²¬ê¸°ì—… (10-50ê°œ ì„œë¹„ìŠ¤)                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Kong Gateway    â”‚    â”‚ Istio (ë¶€ë¶„)    â”‚                            â”‚
â”‚  â”‚ (ì™¸ë¶€ íŠ¸ë˜í”½)    â”‚ +  â”‚ (í•µì‹¬ ì„œë¹„ìŠ¤ë§Œ)  â”‚ â† 60% ì„ íƒ                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚  ì´ìœ : Kongìœ¼ë¡œ ì‹œì‘ â†’ ë³µì¡ë„ ì¦ê°€ì‹œ Istio ì ì§„ ë„ì…                      â”‚
â”‚                                                                         â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”‚
â”‚                                                                         â”‚
â”‚  ëŒ€ê¸°ì—…/ê¸ˆìœµ (50+ ì„œë¹„ìŠ¤)                                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                            â”‚
â”‚  â”‚ Kong Gateway    â”‚    â”‚ Istio Mesh      â”‚                            â”‚
â”‚  â”‚ (DMZ ê²½ê³„)      â”‚ +  â”‚ (ì „ì²´ í´ëŸ¬ìŠ¤í„°)  â”‚ â† 80% ì„ íƒ                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                            â”‚
â”‚  ì´ìœ : ë³´ì•ˆ ìš”êµ¬ì‚¬í•­, ê·œì œ ì¤€ìˆ˜, ë³µì¡í•œ íŠ¸ë˜í”½ ê´€ë¦¬                        â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‹¤ì œ ì•„í‚¤í…ì²˜ íŒ¨í„´ - ì¤‘ê²¬ê¸°ì—… ì˜ˆì‹œ

**í•€í…Œí¬ "PaymentPro" (30ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤)**:

```
                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                          â”‚   Public Internet   â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              DMZ Zone                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                       Kong Gateway                                 â”‚    â”‚
â”‚  â”‚                      (ì™¸ë¶€ API ê´€ë¦¬)                                â”‚    â”‚
â”‚  â”‚                                                                     â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ í”ŒëŸ¬ê·¸ì¸ êµ¬ì„±:                                               â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ OAuth 2.0 (ê³ ê°ì‚¬ ì¸ì¦)                                 â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Rate Limiting (APIë³„ ì°¨ë“±)                              â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Request Validation (ìŠ¤í‚¤ë§ˆ ê²€ì¦)                        â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ â”œâ”€â”€ Response Transform (ë¯¼ê°ì •ë³´ ë§ˆìŠ¤í‚¹)                     â”‚    â”‚    â”‚
â”‚  â”‚  â”‚ â””â”€â”€ WAF (ë³´ì•ˆ í•„í„°ë§)                                       â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚ ë‚´ë¶€ë§ìœ¼ë¡œ ì „ë‹¬
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Private Kubernetes Cluster                        â”‚
â”‚                              (Istio Service Mesh)                          â”‚
â”‚                                                                             â”‚
â”‚  Core Services (Istio ì ìš©)        â”‚  Support Services (Istio ë¯¸ì ìš©)       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚  â”‚ â”‚ Payment â”‚ â”‚ User Mgmt   â”‚ â”‚   â”‚  â”‚ â”‚ Logging â”‚ â”‚ Monitoring  â”‚ â”‚      â”‚
â”‚  â”‚ â”‚ Engine  â”‚ â”‚ Service     â”‚ â”‚   â”‚  â”‚ â”‚ Service â”‚ â”‚ Service     â”‚ â”‚      â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚  â”‚              â†•              â”‚   â”‚  â”‚              â†•              â”‚      â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      â”‚
â”‚  â”‚ â”‚ Fraud   â”‚ â”‚ Transaction â”‚ â”‚   â”‚  â”‚ â”‚ Backup  â”‚ â”‚ Notificationâ”‚ â”‚      â”‚
â”‚  â”‚ â”‚ Service â”‚ â”‚ Service     â”‚ â”‚   â”‚  â”‚ â”‚ Service â”‚ â”‚ Service     â”‚ â”‚      â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                     â”‚                                      â”‚
â”‚  ëª¨ë“  í†µì‹ ì´ mTLSë¡œ ì•”í˜¸í™”          â”‚  ì¼ë°˜ HTTP í†µì‹                        â”‚
â”‚  ë¶„ì‚° ì¶”ì  + ì„¸ë°€í•œ ì ‘ê·¼ ì œì–´       â”‚  ë‹¨ìˆœí•œ êµ¬ì¡°                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### íŠ¸ë˜í”½ ë¶„í•  ì‹œê°í™”

**ì¹´ë‚˜ë¦¬ ë°°í¬ (Canary Deployment)**:

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ VirtualService  â”‚
                    â”‚                 â”‚
          100% â”€â”€â”€â”€â–ºâ”‚ weight:         â”‚
          Traffic   â”‚ - v1: 90%      â”‚
                    â”‚ - v2: 10%      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      Traffic Split            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€[118;1:3uâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â–¼                       â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ 90% to v1   â”‚         â”‚ 10% to v2   â”‚
        â”‚             â”‚         â”‚             â”‚
        â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚         â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
        â”‚ â”‚ App v1  â”‚ â”‚         â”‚ â”‚ App v2  â”‚ â”‚
        â”‚ â”‚ (ì•ˆì •)   â”‚ â”‚         â”‚ â”‚ (í…ŒìŠ¤íŠ¸) â”‚ â”‚
        â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚         â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ì ì§„ì  ì¦ê°€:
Week 1: v1:90%, v2:10%
Week 2: v1:70%, v2:30%
Week 3: v1:50%, v2:50%
Week 4: v1:20%, v2:80%
Week 5: v1:0%,  v2:100% (ì™„ì „ ì „í™˜)
```

**A/B í…ŒìŠ¤íŒ…**:

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ VirtualService  â”‚
                    â”‚                 â”‚
          100% â”€â”€â”€â”€â–ºâ”‚ Header-based    â”‚
          Traffic   â”‚ Routing:        â”‚
                    â”‚                 â”‚
                    â”‚ if user-group   â”‚
                    â”‚   == "beta"     â”‚
                    â”‚ then v2         â”‚
                    â”‚ else v1         â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚       Header ë¶„ì„                  â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â–¼                       â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Beta Users (5%)     â”‚     â”‚ Normal Users (95%)  â”‚
    â”‚                     â”‚     â”‚                     â”‚
    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚     â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
    â”‚ â”‚ New Feature v2  â”‚ â”‚     â”‚ â”‚ Stable v1       â”‚ â”‚
    â”‚ â”‚ (ì‹¤í—˜ ê¸°ëŠ¥)      â”‚ â”‚     â”‚ â”‚ (ê¸°ì¡´ ê¸°ëŠ¥)      â”‚ â”‚
    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ê²°ê³¼ ë¹„êµ:
- ë³€í™˜ìœ¨ (Conversion Rate)
- ì‘ë‹µ ì‹œê°„ (Response Time) 
- ì—ëŸ¬ìœ¨ (Error Rate)
```

---

## Ingress vs Istio Gateway

### ì–¸ì œ ë¬´ì—‡ì„ ì‚¬ìš©í•˜ë‚˜?

**ì‹œë‚˜ë¦¬ì˜¤ë³„ êµ¬ì„± íŒ¨í„´**:

```
ì‹œë‚˜ë¦¬ì˜¤ 1: Istioë§Œ ì‚¬ìš© (Simple êµ¬ì„±)
Internet â†’ Istio Gateway â†’ Service Mesh

ì‹œë‚˜ë¦¬ì˜¤ 2: Ingress + Istio ë³‘ìš© (ì¼ë°˜ì )  
Internet â†’ Nginx Ingress â†’ Istio Gateway â†’ Service Mesh

ì‹œë‚˜ë¦¬ì˜¤ 3: Kong + Istio ë³‘ìš© (Enterprise)
Internet â†’ Kong Gateway â†’ Istio Gateway â†’ Service Mesh
```

### íŒ¨í„´ 1: "Istio Gatewayë§Œ ì‚¬ìš©" (30% ê¸°ì—…)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    HTTPS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    mTLS    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Client    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Istio Gateway   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Service Mesh â”‚
â”‚ (ì™¸ë¶€ ì‚¬ìš©ì) â”‚             â”‚ (Ingress ì—­í• )   â”‚            â”‚ (ë‚´ë¶€ ì„œë¹„ìŠ¤) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì‹¤ì œ YAML**:
```yaml
apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: main-gateway
  namespace: istio-system
spec:
  selector:
    istio: ingressgateway  # Istio Ingress Gateway Pod
  servers:
  - port:
      number: 443
      name: https
      protocol: HTTPS
    hosts:
    - "api.company.com"    # ì™¸ë¶€ì—ì„œ ë°”ë¡œ ì ‘ê·¼
    - "app.company.com"
    tls:
      mode: SIMPLE
      credentialName: company-tls
      
---
apiVersion: networking.istio.io/v1beta1  
kind: VirtualService
metadata:
  name: api-routing
spec:
  hosts:
  - "api.company.com"
  gateways:
  - main-gateway           # ìœ„ Gateway ì—°ê²°
  http:
  - match:
    - uri:
        prefix: "/api/users"
    route:
    - destination:
        host: user-service  # ì§ì ‘ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ…
        port:
          number: 8080
```

### íŒ¨í„´ 2: "Nginx Ingress + Istio" (50% ê¸°ì—…)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   HTTPS   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   HTTP   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   mTLS   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Client   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Nginx Ingress   â”‚ â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Istio Gateway   â”‚ â”€â”€â”€â”€â”€â”€â”€â–º â”‚ Service Mesh â”‚
â”‚(ì™¸ë¶€ ì‚¬ìš©ì)â”‚           â”‚ (SSL ì¢…ë£Œ,      â”‚          â”‚ (ë©”ì‹œ ì§„ì…ì )    â”‚          â”‚ (ë‚´ë¶€ ì„œë¹„ìŠ¤) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  Load Balance)  â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ê¸°ëŠ¥ ë¹„êµ

```
ì „í†µì ì¸ Ingress Controller (Nginx/HAProxy):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ê¸°ëŠ¥ ë²”ìœ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… SSL ì¢…ë£Œ (TLS Termination)                           â”‚
â”‚ âœ… ë„ë©”ì¸ ê¸°ë°˜ ë¼ìš°íŒ… (Host-based Routing)               â”‚  
â”‚ âœ… ê²½ë¡œ ê¸°ë°˜ ë¼ìš°íŒ… (Path-based Routing)                â”‚
â”‚ âœ… ë¡œë“œ ë°¸ëŸ°ì‹± (ê¸°ë³¸)                                   â”‚
â”‚ âœ… Rate Limiting (ê¸°ë³¸)                                â”‚
â”‚                                                        â”‚
â”‚ âŒ ì„œë¹„ìŠ¤ ê°„ í†µì‹  ê´€ë¦¬ ë¶ˆê°€                             â”‚
â”‚ âŒ mTLS ìë™í™” ë¶ˆê°€                                    â”‚
â”‚ âŒ ë¶„ì‚° ì¶”ì  ë¶ˆê°€                                      â”‚
â”‚ âŒ ì„¸ë°€í•œ íŠ¸ë˜í”½ ì œì–´ ë¶ˆê°€                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Istio Gateway:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ê¸°ëŠ¥ ë²”ìœ„                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âœ… ëª¨ë“  ì „í†µ Ingress ê¸°ëŠ¥                               â”‚
â”‚ âœ… ì„œë¹„ìŠ¤ ë©”ì‹œì™€ ì™„ì „ í†µí•©                               â”‚
â”‚ âœ… ê³ ê¸‰ íŠ¸ë˜í”½ ë¶„í•  (ê°€ì¤‘ì¹˜, í—¤ë” ê¸°ë°˜)                  â”‚
â”‚ âœ… ìë™ mTLS                                           â”‚
â”‚ âœ… ë¶„ì‚° ì¶”ì                                            â”‚
â”‚ âœ… ì„¸ë°€í•œ ë³´ì•ˆ ì •ì±…                                     â”‚
â”‚                                                        â”‚
â”‚ âŒ SSL ê´€ë¦¬ê°€ ë³µì¡                                     â”‚
â”‚ âŒ ì„¤ì •ì´ ë³µì¡                                         â”‚  
â”‚ âŒ í•™ìŠµ ê³¡ì„  ë†’ìŒ                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ë„êµ¬ ìƒíƒœê³„

### Istio ìƒíƒœê³„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Istio ì „ì²´ ìŠ¤íƒ                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  Control Plane                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Istiod                                                              â”‚    â”‚
â”‚  â”‚ â”œâ”€â”€ Pilot (íŠ¸ë˜í”½ ê´€ë¦¬)                                             â”‚    â”‚
â”‚  â”‚ â”œâ”€â”€ Citadel (ë³´ì•ˆ)                                                  â”‚    â”‚
â”‚  â”‚ â””â”€â”€ Galley (ì„¤ì • ê²€ì¦)                                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                     â”‚                                       â”‚
â”‚  Data Plane                         â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                       â”‚
â”‚  â”‚ Envoy Proxies                   â”‚ â”‚                                       â”‚
â”‚  â”‚ â”œâ”€â”€ Traffic Management          â”‚ â”‚                                       â”‚
â”‚  â”‚ â”œâ”€â”€ Security (mTLS)             â”‚ â”‚                                       â”‚
â”‚  â”‚ â””â”€â”€ Telemetry Collection        â”‚ â”‚                                       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                       â”‚
â”‚                                     â”‚                                       â”‚
â”‚  ê´€ì¸¡ì„± Stack                       â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                       â”‚
â”‚  â”‚ Kiali (ì„œë¹„ìŠ¤ ë©”ì‹œ ì‹œê°í™”)       â”‚â—„â”˜                                       â”‚
â”‚  â”‚ Jaeger (ë¶„ì‚° ì¶”ì )               â”‚                                        â”‚
â”‚  â”‚ Prometheus (ë©”íŠ¸ë¦­)              â”‚                                        â”‚
â”‚  â”‚ Grafana (ëŒ€ì‹œë³´ë“œ)               â”‚                                        â”‚
â”‚  â”‚ Zipkin (ì¶”ê°€ ì¶”ì  ì˜µì…˜)          â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â”‚                                                                             â”‚
â”‚  ì¶”ê°€ í†µí•© ë„êµ¬                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ Flagger (Progressive Delivery)                                      â”‚    â”‚
â”‚  â”‚ Argo Rollouts (ê³ ê¸‰ ë°°í¬)                                           â”‚    â”‚
â”‚  â”‚ Open Policy Agent (ì •ì±… ì—”ì§„)                                       â”‚    â”‚
â”‚  â”‚ Falco (ëŸ°íƒ€ì„ ë³´ì•ˆ)                                                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ì‹¤ì œ Istio + ë„êµ¬ ì—°ë™

**Istio + Flagger (ì¹´ë‚˜ë¦¬ ë°°í¬ ìë™í™”)**:
```yaml
apiVersion: flagger.app/v1beta1
kind: Canary
metadata:
  name: payment-service
  namespace: production
spec:
  provider: istio
  targetRef:
    apiVersion: apps/v1
    kind: Deployment
    name: payment-service
  service:
    port: 8080
  analysis:
    interval: 1m
    threshold: 5
    iterations: 10
    metrics:
    - name: request-success-rate
      thresholdRange:
        min: 99
    - name: request-duration
      thresholdRange:
        max: 500
  canaryAnalysis:
    stepWeight: 10    # 10%ì”© ì¦ê°€
    maxWeight: 50
```

**Istio + OPA (ì •ì±… ê¸°ë°˜ ì ‘ê·¼ ì œì–´)**:
```yaml
apiVersion: security.istio.io/v1beta1
kind: AuthorizationPolicy
metadata:
  name: opa-policy
spec:
  selector:
    matchLabels:
      app: payment-service
  rules:
  - to:
    - operation:
        methods: ["POST"]
    when:
    - key: custom.opa_decision
      values: ["allow"]
```

### ì‹¤ë¬´ ìš´ì˜ ì§€í‘œ

**Istio ìš´ì˜ ì§€í‘œ**:
```bash  
# 1. ì„œë¹„ìŠ¤ ê°„ ì„±ê³µë¥ 
istio_request_total{reporter="destination",response_code!~"5.*"}
/ istio_request_total{reporter="destination"} * 100

# 2. mTLS ì ìš©ë¥  
sum(istio_requests_total{source_workload!="unknown"}) 
/ sum(istio_requests_total) * 100

# 3. Circuit Breaker ë™ì‘
envoy_cluster_upstream_rq_pending{envoy_cluster_name="outbound|80||payment-service"}

# 4. ì„œë¹„ìŠ¤ ë©”ì‹œ ê±´ê°•ë„
sum(up{job="istio-proxy"}) / count(up{job="istio-proxy"}) * 100
```

---

## ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œë‚˜ë¦¬ì˜¤

### ì‹¤ì œ ë§ˆì´ê·¸ë ˆì´ì…˜ ì‚¬ë¡€: "TechCorp"

```bash
# Phase 1: í˜„ì¬ (Nginx Ingressë§Œ)
Internet â†’ Nginx Ingress â†’ Services (20ê°œ)
ë¬¸ì œì : ì„œë¹„ìŠ¤ ê°„ í†µì‹  ê°€ì‹œì„± ë¶€ì¡±, ë³´ì•ˆ ì·¨ì•½

# Phase 2: Istio ë¶€ë¶„ ë„ì… (6ê°œì›”)  
Internet â†’ Nginx Ingress â†’ Istio Gateway â†’ Core Services (5ê°œ)
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ Other Services (15ê°œ)
ê²°ê³¼: í•µì‹¬ ì„œë¹„ìŠ¤ ì•ˆì •ì„± í–¥ìƒ

# Phase 3: ì™„ì „ ì „í™˜ (1ë…„)
Internet â†’ Nginx Ingress â†’ Istio Gateway â†’ All Services (20ê°œ)
ê²°ê³¼: ì™„ì „í•œ Service Mesh, ëª¨ë“  í†µì‹  mTLS

# Phase 4: Kong ë„ì… (1.5ë…„) - API ë¹„ì¦ˆë‹ˆìŠ¤ í™•ì¥
Internet â†’ Kong Gateway â†’ Istio Gateway â†’ All Services
ê²°ê³¼: ì™¸ë¶€ íŒŒíŠ¸ë„ˆ API, ìˆ˜ìµí™” ê°€ëŠ¥
```

### ê¸ˆìœµíšŒì‚¬ ë””ì§€í„¸ ì „í™˜ ë¡œë“œë§µ

```
Quarter 1: ë³´ì•ˆ ì¤‘ì‹¬ Kong ë„ì…
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Month 1: Kong Enterprise + PostgreSQL HA êµ¬ì¶•             â”‚
â”‚          WAF, API Key, OAuth 2.0 ì ìš©                     â”‚
â”‚                                                            â”‚ 
â”‚ Month 2: ë ˆê±°ì‹œ ì‹œìŠ¤í…œ ì—°ë™ (Request/Response Transform)    â”‚
â”‚          ìƒì„¸í•œ ê°ì‚¬ ë¡œê·¸ ì‹œìŠ¤í…œ êµ¬ì¶•                       â”‚
â”‚                                                            â”‚
â”‚ Month 3: ì¬í•´ë³µêµ¬ ì‹œìŠ¤í…œ, ì„±ëŠ¥ í…ŒìŠ¤íŠ¸                       â”‚
â”‚          ë³´ì•ˆ ê°ì‚¬ ë° ì¸ì¦ íšë“                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Quarter 2-3: Istio ë‹¨ê³„ì  ë„ì…  
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Month 4-5: í•µì‹¬ ê²°ì œ ì„œë¹„ìŠ¤ë§Œ Istio ì ìš©                   â”‚
â”‚            mTLS ê°•ì œ, ì„¸ë°€í•œ ì ‘ê·¼ ì œì–´                     â”‚
â”‚                                                            â”‚
â”‚ Month 6-7: ì‚¬ìš©ì ê´€ë ¨ ì„œë¹„ìŠ¤ í™•ì¥                         â”‚  
â”‚            Zero Trust ë„¤íŠ¸ì›Œí‚¹ ì™„ì„±                        â”‚
â”‚                                                            â”‚
â”‚ Month 8-9: ì „ì²´ ì„œë¹„ìŠ¤ ì „í™˜                                â”‚
â”‚            ì™„ì „í•œ Service Mesh êµ¬ì¶•                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Quarter 4: ê³ ë„í™”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Month 10-12: ë©€í‹° í´ëŸ¬ìŠ¤í„°, ë©€í‹° ë¦¬ì „ í™•ì¥                 â”‚
â”‚              ê³ ê¸‰ ê´€ì¸¡ì„±, ìë™í™”ëœ ì¹´ë‚˜ë¦¬ ë°°í¬              â”‚
â”‚              ì‹¤ì‹œê°„ ì´ìƒ íƒì§€ ë° ìë™ ë³µêµ¬                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ê²°ë¡ 

**IstioëŠ” ì–¸ì œ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜?**

```bash
âœ… ì í•©í•œ ê²½ìš°:
- ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ 20ê°œ ì´ìƒ
- ì„œë¹„ìŠ¤ ê°„ ë³´ì•ˆì´ ì¤‘ìš”
- ë³µì¡í•œ íŠ¸ë˜í”½ ì œì–´ í•„ìš”
- Zero Trust ë„¤íŠ¸ì›Œí¬ êµ¬ì¶•
- ë¶„ì‚° ì¶”ì ì´ í•„ìš”
- ì¹´ë‚˜ë¦¬ ë°°í¬, A/B í…ŒìŠ¤íŒ… í•„ìš”

âŒ ë¶€ì í•©í•œ ê²½ìš°:
- ë‹¨ìˆœí•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜
- ì„œë¹„ìŠ¤ ê°œìˆ˜ê°€ ì ìŒ (< 10ê°œ)
- íŒ€ì˜ í•™ìŠµ ì‹œê°„ ë¶€ì¡±
- ë ˆê±°ì‹œ ì‹œìŠ¤í…œì´ ëŒ€ë¶€ë¶„
- ì¦‰ì‹œ ê²°ê³¼ê°€ í•„ìš”í•œ ìƒí™©
```

**í•µì‹¬ í¬ì¸íŠ¸**:
1. **IstioëŠ” Kongì„ ëŒ€ì²´í•˜ëŠ” ê²ƒì´ ì•„ë‹˜** - ì„œë¡œ ë‹¤ë¥¸ ë¬¸ì œë¥¼ í•´ê²°
2. **ë‹¨ê³„ì  ë„ì…ì´ í•µì‹¬** - í•µì‹¬ ì„œë¹„ìŠ¤ë¶€í„° ì‹œì‘
3. **ìš´ì˜íŒ€ ì—­ëŸ‰ì´ ì¤‘ìš”** - ì¶©ë¶„í•œ í•™ìŠµê³¼ ì¤€ë¹„ í•„ìš”
4. **ê´€ì¸¡ì„±ì´ í•µì‹¬ ê°€ì¹˜** - Kiali, Jaeger, Prometheus í•„ìˆ˜
